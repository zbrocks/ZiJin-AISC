function n(){const n=document.querySelectorAll('.page-header, .stat-card, .article-card, .timeline-item, .subscription-card'),t=new IntersectionObserver(n=>{n.forEach((n,e)=>{n.isIntersecting&&(setTimeout(()=>{n.target.style.opacity='1',n.target.style.transform='translateY(0)'},100*e),t.unobserve(n.target))})},{threshold:.1,rootMargin:'0px 0px -50px 0px'});n.forEach(n=>{n.style.opacity='0',n.style.transform='translateY(30px)',n.style.transition='all 0.6s ease',t.observe(n)})}function t(){const n=document.querySelectorAll('.stat-number'),t=new IntersectionObserver(n=>{n.forEach(n=>{n.isIntersecting&&((n=>{const t=parseInt(n.textContent.replace(/[^\d]/g,''))||0,e=Math.max(t/50,1);let o=0;const r=setInterval(()=>{o+=e,o>=t?(n.textContent=n.textContent.replace(/\d+/,t),clearInterval(r)):n.textContent=n.textContent.replace(/\d+/,Math.floor(o))},30)})(n.target),t.unobserve(n.target))})});n.forEach(n=>{t.observe(n)})}function e(){document.querySelectorAll('.article-card, .stat-card').forEach(n=>{n.addEventListener('mouseenter',function(){this.classList.contains('placeholder')||(this.style.transform='translateY(-8px) scale(1.02)')}),n.addEventListener('mouseleave',function(){this.style.transform='translateY(0) scale(1)'}),n.classList.contains('featured')&&(n.addEventListener('mouseenter',function(){this.style.boxShadow='0 20px 50px rgba(255, 215, 0, 0.3)'}),n.addEventListener('mouseleave',function(){this.style.boxShadow=''}))})}function o(){const n=document.querySelectorAll('.timeline-item'),t=new IntersectionObserver(n=>{n.forEach(n=>{if(n.isIntersecting){n.target.classList.add('animate-in');n.target.querySelector('.timeline-content');const e=n.target.querySelector('.timeline-marker');setTimeout(()=>{e.style.transform='scale(1.1)',setTimeout(()=>{e.style.transform='scale(1)'},200)},300),t.unobserve(n.target)}})},{threshold:.3});n.forEach(n=>{t.observe(n)})}function r(){window.shareArticle=function(n){const t=window.location.href,e=`推荐阅读:${n}`;navigator.share?navigator.share({title:n,text:e,url:t}).catch(e=>{a(n,t)}):a(n,t)}}function a(n,t){i([{name:'复制链接',action:()=>{navigator.clipboard.writeText(t).then(()=>{s('链接已复制到剪贴板','success')}).catch(()=>{s('复制失败,请手动复制','error')})}},{name:'微信分享',action:()=>{s('请复制链接后在微信中分享','info'),navigator.clipboard.writeText(t)}},{name:'QQ分享',action:()=>{const e=`https://connect.qq.com/widget/shareqq/index.html?url=${encodeURIComponent(t)}&title=${encodeURIComponent(n)}`;window.open(e,'_blank')}}])}function i(n){const t=document.createElement('div');t.className='share-modal',t.innerHTML=`\n        <div class="share-modal-content">\n            <div class="share-modal-header">\n                <h3>分享文章</h3>\n                <button class="close-btn">&times;</button>\n            </div>\n            <div class="share-options">\n                ${n.map(n=>`\n                    <button class="share-option" data-action="${n.name}">\n                        <i class="fas fa-share-alt"></i>\n                        ${n.name}\n                    </button>\n                `).join('')}\n            </div>\n        </div>\n    `,document.body.appendChild(t),t.querySelector('.close-btn').addEventListener('click',()=>{document.body.removeChild(t)}),t.addEventListener('click',n=>{n.target===t&&document.body.removeChild(t)}),n.forEach((n,e)=>{t.querySelector(`[data-action="${n.name}"]`).addEventListener('click',()=>{n.action(),document.body.removeChild(t)})})}function s(n,t='info'){const e=document.createElement('div');e.className=`notification notification-${t}`,e.innerHTML=`\n        <div class="notification-content">\n            <i class="fas fa-${c(t)}"></i>\n            <span>${n}</span>\n        </div>\n    `,document.body.appendChild(e),setTimeout(()=>{e.classList.add('show')},100),setTimeout(()=>{e.classList.remove('show'),setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e)},300)},3e3)}function c(n){return{success:'check-circle',error:'exclamation-circle',warning:'exclamation-triangle',info:'info-circle'}[n]||'info-circle'}document.addEventListener('DOMContentLoaded',function(){n(),t(),e(),o(),initSubscriptionFeature(),r()}),window.addEventListener('load',()=>{document.body.style.opacity='1'}),document.body.style.opacity='0',document.body.style.transition='opacity 0.5s ease';const l=document.createElement('style');l.textContent='\n    .timeline-item.animate-in .timeline-content {\n        animation: slideInContent 0.6s ease forwards;\n    }\n    \n    @keyframes slideInContent {\n        from {\n            opacity: 0;\n            transform: translateX(30px);\n        }\n        to {\n            opacity: 1;\n            transform: translateX(0);\n        }\n    }\n    \n    .timeline-item:nth-child(even).animate-in .timeline-content {\n        animation: slideInContentReverse 0.6s ease forwards;\n    }\n    \n    @keyframes slideInContentReverse {\n        from {\n            opacity: 0;\n            transform: translateX(-30px);\n        }\n        to {\n            opacity: 1;\n            transform: translateX(0);\n        }\n    }\n    \n    .share-modal {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 1000;\n    }\n    \n    .share-modal-content {\n        background: var(--current-card-bg);\n        border-radius: 15px;\n        padding: 30px;\n        max-width: 400px;\n        width: 90%;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n    }\n    \n    .share-modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n    }\n    \n    .share-modal-header h3 {\n        margin: 0;\n        color: var(--current-primary);\n    }\n    \n    .close-btn {\n        background: none;\n        border: none;\n        font-size: 1.5em;\n        cursor: pointer;\n        color: var(--current-text-secondary);\n    }\n    \n    .share-options {\n        display: grid;\n        gap: 10px;\n    }\n    \n    .share-option {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n        padding: 15px;\n        background: rgba(134, 93, 187, 0.1);\n        border: none;\n        border-radius: 10px;\n        cursor: pointer;\n        color: var(--current-text);\n        transition: all 0.3s ease;\n    }\n    \n    .share-option:hover {\n        background: rgba(134, 93, 187, 0.2);\n        transform: translateY(-2px);\n    }\n    \n    .notification {\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: var(--current-card-bg);\n        border-radius: 10px;\n        padding: 15px 20px;\n        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n        transform: translateX(400px);\n        transition: all 0.3s ease;\n        z-index: 1001;\n        border-left: 4px solid;\n    }\n    \n    .notification.show {\n        transform: translateX(0);\n    }\n    \n    .notification-success {\n        border-left-color: #4CAF50;\n    }\n    \n    .notification-error {\n        border-left-color: #f44336;\n    }\n    \n    .notification-warning {\n        border-left-color: #FFC107;\n    }\n    \n    .notification-info {\n        border-left-color: var(--current-primary);\n    }\n    \n    .notification-content {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n        color: var(--current-text);\n    }\n    \n    .notification-success .notification-content i {\n        color: #4CAF50;\n    }\n    \n    .notification-error .notification-content i {\n        color: #f44336;\n    }\n    \n    .notification-warning .notification-content i {\n        color: #FFC107;\n    }\n    \n    .notification-info .notification-content i {\n        color: var(--current-primary);\n    }\n',document.head.appendChild(l),'ontouchstart'in window&&document.addEventListener('touchstart',()=>{document.querySelectorAll('.article-card, .stat-card').forEach(n=>{n.style.cursor='pointer'})});